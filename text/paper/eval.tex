\documentclass[a4paper, 11pt]{article}
\usepackage{/Users/fgu/dev/projects/dotfiles/latex/paper}
\bibliography{/Users/fgu/dev/projects/dotfiles/latex/fabib}
\onehalfspacing

\newcommand{\figdir}{../../output/figures}
\newcommand{\tabdir}{../../output/tables}

\title{\textbf{Evaluation\footnote{This research was supported by Economic and Social Research Council grant number ES/V004867/1. WBS ethics code: E-414-01-20.}}}

\author{
    Fabian Gunzinger \\ Warwick Business School
    \and
    Neil Stewart \\ Warwick Business School
}

\date{\today}

\begin{document}

\maketitle
% \input{sections/abstract.tex}

\tableofcontents
\newpage

% \input{sections/intro.tex}
\section{Introduction}%
\label{sec:introduction}


% \input{sections/methods.tex}
\section{Methods}%
\label{sec:data}

While we were unable to pre-register the analysis because we have had access to
and been working with the Money Dashoard data for months, we proceeded in the
same spirit: we first wrote a draft of the paper in the form of a pre-analysis
plan, following \citet{olken2015promises}, then tested the entire code base --
data pre-processing, balance checks, main analysis, and extensions -- with a 1
percent sample, and finally ran the entire analysis.


\subsection{Dataset}%
\label{sub:dataset}


\subsection{Sample selection}%
\label{sub:sample_selection}

To assess the impact of MDB use on users' financial behaviour we need to
observe their relevant financial history for a sufficiently long period of time
prior to and after they started using the app. For our purpose here, ``relevant
financial history'' includes the complete set of spending transactions and all
savings account inflows and outflows, and ``sufficiently long period'' is a
period of 6 months prior to and after signup, with the month of signup being
the first month of the latter period.\footnote{In
Appendix~\ref{sub:alternative_matching_method} we show results with different
window lengths. \edit{The results are unchanged.}}

Table X provides an overview of the precise conditions we applied to implement
these criteria and their effect on the sample size. The set of functions that
implement each condition can be found on \href{path-to-github}{path to github}.


\subsection{Treatment}%
\label{sub:treatment}

Provide information about signup patterns


\subsection{Outcomes}%
\label{sub:outcomes}

\paragraph{Primary outcome}%
\label{par:primary_outcome}

Our main outcome variable is savings as a proportion of monthly income, where
we measure savings as the sum of all savings account inflows.


\paragraph{Secondary outcomes}%
\label{par:secondary_outcomes}

For a more nuanced understanding of how app use affects savings we also
consider net-savings -- total savings account inflows minus outflows -- as a
proportion of monthly income to see whether a willingness to save more might be
offset by a (later) need to withdraw funds, and a dummy variable for whether a
user has any savings account inflows in a given month to see whether the app
helps users save at all. To investigate possible channels, we consider total
spend, highly discretionary spend, banking charges, the total amount of
borrowing, as well as payday borrowing, all as proportion of monthly income. We
think of these additional outcomes as exploratory and do not make any
adjustments for multiple hypothesis testing.\footnote{For a recent
game-theoretically motivated discussion of when and how to correct for multiple
hypothesis testing, see \citet{viviano2021should}.}

An alternative approach, based on \citet{anderson2008multiple}, would be to
group outcomes into ``savings'', ``spending'', ``borrowing'', and ``fees'', and
consider them as different dimensions of a latent variable of interest which we
might call ``financial management skills''. We do not do that for two reasons:
first and foremost, because we think it is natural to think of the amount saved
as the ultimate outcome and of other outcomes as providing a more nuanced
understanding of savings behaviour or as suggesting possible channels through
which app use affects savings. Thinking of savings as the main goal is also
reflected in Money Dashboard's main promise, which is to help users spend less
and save more, as shown in Figure~\ref{fig:mdb_website}. Second, as pointed out
in \citet{carlin2017fintech}, incurring overdraft fees is not an unambiguous
sign of a financial mistake, as the opportunity to go into overdraft confers a
benefit to the consumer.\footnote{For further discussions on fees, see
\citet{jorring2020financial, stango2009consumers}.}

\subsection{Covariates}%
\label{sub:covariates}

Description of covariates.


\subsection{Difference-in-difference}%
\label{sub:difference_in_difference}

Control group design:
\begin{itemize}

    \item We only have data for a self-selected group of people who choose to
        use Money Dashboard. By virtue of signing up to an app that helps them
        manage their money, these users are different from those who don't sign
        up. As a result, we are unable to answer the question of whether use of
        Money Dashboard helps the average person in the population as a whole
        save more.\footnote{One way to get closer to that answer is to
            re-weight our sample on observable demographic variables so as to
            match the UK population as a whole. But our sample differs from the
            population as a whole both is ways that are observable (demographic
            variables) and unobservable (self-awareness that they need help
            managing their money, cognitive resources to engage with the app,
            motivation to do so). Re-weighting would only help us deal with the
        first of these.} Instead, we are answering the question whether Money
        Dashboard succeeds in helping its \textit{users} save more.

    \item Money Dashboard can access up to three years of historic data for
        each account a user links to their account.

    \item Each user for whom we have sufficient data thus serves as both a
        treatment unit and a potential control unit.

    \item We use a difference-in-differences design to estimate the effect of
        app use. Because we do not have a separate control group, we use the
        per-signup data of Money Dashboard users as control periods and use
        matching to find comparable control user for each tretment user.

    \item To perform the matching, we proceed as follows:

    \item Selection of covariates: all variables that simultaneously affect
        treatment and outcomes. No need to control for fixed effects: these
        capture unobserved time-invariant factors that make an individual sign
        up to MDB and affect its spending habits. Given that these are time
        invariant, and that all users eventually sign up, there is no
        difference between control and treatment units in these factors. Month
        of year: should probably include, as can affect p of signup and
        spending behaviour.

    \item For treatment units, we select data for six months before and after
        signup, where the month of the signup is treated as the first of the
        six after-signup months. For each user, we then calculate the mean
        value of each covariate for the pre-signup period.

    \item We construct potential control units as all 12-month data windows we
        observe before signup, and for each potential control unit calculate
        the mean value of each covariate for the first six months.


    \item Calculate propensity scores and eliminate obs outside common support?


    \item We use matching proceedure introduced in \citet{ho2007matching} and
        implemented in the \textit{MatchIt} R-package \citep{stuart2011matchit} to
        find most similar comparison unit for each treatment unit.

    \item Choice of exact matching proceedure:

        \begin{itemize}

            \item \edit{Matching with or without replacement? I'd think with,
                but read papers and check vignettes for trade-offs.}
                \citet{ho2007matching}: if many more good (with common support)
                control than treatment units available, use many to one
                matching, else do matching with replacement. Check for common
                support using convex hull analysis from
                \citet{king2006dangers}.

            \item Match more exactly on variables that are more correlated with
                outcome. How to determine? Correlation? Cutoff for "high"
                correlation?

            \item We start with exact matching (matching all possible control
                units that exactly match the treatment unit). For continuous
                variables, we use 6 buckets (default in
                \citet{stuart2011matchit}).

            \item If we match more than X percent of treatment observations, we
                stop. If not, we move to another approach. The goal of
                proceedure is to avoid biased estimates due to the deletion of
                too many treatment units \citep{rosenbaum1985bias}.

            \item We use nearest-neighbour matching based on propensity score.
                If we succeed in balancing covariates, we stop. If we don't we
                use more sophisticated specifications to estimate the
                propensity score. See \citet{ho2007matching} section 6.4.

            \item We asses balance following
                \href{https://kosukeimai.github.io/MatchIt/articles/assessing-balance.html}{vignette}.

            \item Check for reduction in moden dependence producing equivalent
                of Fig. 2 in \citet{ho2007matching}.

        \end{itemize}
\end{itemize}


Open questions:
\begin{itemize}
    \item Do we include fixed effects after matching? Reason not to: we use the
        same units for treatment and control, so time-invariant unobserved
        differences should be equally distributed across treatment and control.

    \item How does event studies in \citet{sun2021estimating} relate to all
        this? Is key difference that event studies use periods since treatment
        rather than time?

\end{itemize}


% Estimation equation for static comparison:
% \begin{equation}
%     y_{it} = \alpha + 
% \end{equation}

Estimating treatment effects
\begin{itemize}

    \item Our estimate is the ATT, not the ATE. 

    \item First, we present pre and post signup comparisons without matching
        (i.e. control group is user pre-signup).

    \item Second, we present (static) pre-post using matched comparisons.

    \item Third, we present dynamic pre-post using matched comparisons. Need to
        think about how this relates to \citet{sun2021estimating}, who propose
        an unbiased estimator for dynamic two-way FE event study designs. I
        think our analysis nests theirs, since we might still want to include
        fixed and time effects, though I need to think about this. (Reason to
        do so: we won't be able to match perfectly, so including user and time
        fixed effects to control for unit and time invariant variation still
        seems useful).

    \item As alternative to matching, consider synthetic controls for
        disaggregated data \citep{abadie2021penalized}.

\end{itemize}

Is estimate causal?
\begin{itemize}
    \item \citet{king2006dangers} show that there are four sources of bias
        (ommitted variable, posttreatment, interpolation, extrapolation).
    
    \item Discuss each in turn to argue that effect is causal (for our population
        of interest, which are people signing up to MDB). 
\end{itemize}


% \input{sections/results.tex}
\section{Results}%
\label{sec:results}

Main results: Figure and associated table akin to sakaguchi2022default Figure 2
and Table 6.

\subsection{Descriptive analysis}%
\label{sub:descriptive_analysis}

\subsection{Difference-in-difference analysis}%
\label{sub:difference_in_difference_analysis}

\subsection{Subgroups}%
\label{sub:subgroups}

To analyse which groups benefit most from adopting Money Dashboard, we split
our sample by gender, generation, income quartiles, and pre-adoption savings
behaviour.

We define generations as follows: boomers were born between 1946 and 1964, Gen
X between 1965 and 1980, Millennials between 1981 and 1996, and Gen Z after
1997.\footnote{Based on age ranges provides by
    \href{https://www.beresfordresearch.com/age-range-by-generation/}{Beresford
Research}.}

Subgroup analysis: same Fig an Tab as in main analysis, but with line for each
subgroup. One figure for each of: gender, generations, income terciles,
per-adoption average savings tercile (inspired by \citet{carlin2017fintech},
see Fig 5 and Table 4).

% \input{sections/discussion.tex}
\section{Discussion}%
\label{sec:discussion}


\newpage
\printbibliography
\newpage

% \input{sections/appendix.tex}
\appendix

\section{Money Dashboard application}%
\label{sec:money_dashboard_application}

\begin{figure}[htpb]
    \centering
    \caption{Money Dashboard website screenshot}%
    \includegraphics[width=0.8\linewidth]{\figdir/mdb_website}
    \label{fig:mdb_website}
\end{figure}
\fignote{\textwidth}{Screenshot from the top of the Money Dashboard website, at
\href{https://www.moneydashboard.com}{moneydashboard.com}, accessed on 29 April
2022.}

\section{Variable definitions}%
\label{sec:variable_definitions}

Complete steps from raw data to variables used in analysis, with links to code
on Github.


\section{Alternative control group designs}%
\label{sec:alternative_control_group_designs}

\subsection{Alternative window lengths}%
\label{sub:alternative_window_lengths}

Show results for 12 months on either end.

\subsection{Alternative matching method}%
\label{sub:alternative_matching_method}

\subsection{Post treatment periods as control}%
\label{sub:post_treatment_periods_as_control}

\subsection{Synthetic controls}%
\label{sub:synthetic_controls}

\subsection{Classic two-way fixed-effects model}%
\label{sub:classic_two_way_fixed_effects_model}

As discussed in \citet{imai2021matching}.

\subsection{Alternative two-way fixed-effects model}%
\label{sub:alternative_two_way_fixed_effects_model}

Use fixest implementation of \citet{sun2021estimating}.





See \citet{abadie2021penalized} for how to use synthetic controls for
disaggregated data.




\end{document}
